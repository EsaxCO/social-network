(this.webpackJsonplesson=this.webpackJsonplesson||[]).push([[4],{299:function(e,a,t){},300:function(e,a,t){},301:function(e,a,t){},302:function(e,a,t){},303:function(e,a,t){},327:function(e,a,t){"use strict";t.r(a);var n=t(5),s=t.n(n),c=t(11),r=t(71),i=t(0),o=t.n(i),l=(t(299),t(300),t(301),t(10)),u=function(e){var a=e.id,t=e.name,n=e.count,s=e.status;return o.a.createElement("li",{className:"section-dialogs-inner-members-li"},o.a.createElement(l.c,{className:"section-dialogs-inner-members-li-url",to:"/home/dialogs/"+a},t,s?o.a.createElement("div",{className:"new-message"},"\u041d\u043e\u0432\u044b\u0445 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0439: ",n):null))},m={count:0};function d(e,a){switch(a.type){case"set":return{count:a.number};default:throw new Error}}var g=function(e){var a=e.instance,t=Object(i.useReducer)(d,m),n=Object(r.a)(t,2),l=(n[0],n[1]),g=Object(i.useState)([]),f=Object(r.a)(g,2),b=f[0],v=f[1],E=Object(i.useState)(!1),p=Object(r.a)(E,2),j=p[0],O=p[1],N=Object(i.useCallback)((function(e){l({type:"set",number:e})})),h=setTimeout((function(){O(!j)}),35e3);Object(i.useEffect)((function(){var e=function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get("/dialogs");case 2:200===(t=e.sent).status&&b!==t.data&&v(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return function(){var e=Object(c.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.get("/dialogs/messages/new/count");case 2:200===(t=e.sent).status&&N(t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),e(),function(){clearTimeout(h)}}),[j]);var w=b.map((function(e){return o.a.createElement(u,{status:e.hasNewMessages,count:e.newMessagesCount,key:e.id,id:e.id,name:e.userName})}));return o.a.createElement("ul",{className:"section-dialogs-inner-members"},w)},f=t(17),b=t(62),v=(t(302),t(95)),E=t.n(v),p=t(34),j=(t(303),t(128)),O=t(129),N=Object(O.a)({form:"SendMessageFormn"})((function(e){var a=e.handleSubmit;return o.a.createElement("form",{onSubmit:a,name:"SendMessage"},o.a.createElement("div",{className:"section-dialogs-inner-newmessage"},o.a.createElement(j.a,{name:"message",component:"textarea",className:"section-dialogs-inner-newmessage-input",id:"",rows:"2"}),o.a.createElement("button",{className:"section-dialogs-inner-newmessage-button"},"Send Message")))})),h=function(e){var a=e.onSubmit;return o.a.createElement(N,{onSubmit:a})},w=t(53),k=t(304),y=t(310),P=function(e){var a=e.total,t=e.avatar,n=e.setPageCurrent,s=e.id,c=e.currentPage,r=e.mainMessageData,i=function(e,a){n(e)},l={backgroundColor:"rgb(7, 2, 91)",color:"#ffffff",textTransform:"uppercase"},u={backgroundColor:"#07025b",fontWeight:"700",color:"#ffffff"};return o.a.createElement(o.a.Fragment,null,o.a.createElement(k.a,{className:"pagination-style",total:a,limit:10,pageCount:10,currentPage:c},(function(e){var a=e.pages,t=e.currentPage,n=e.hasNextPage,s=e.hasPreviousPage,c=e.previousPage,r=e.nextPage,m=e.totalPages,d=e.getPageItemProps;return o.a.createElement("div",null,o.a.createElement("button",d({pageValue:1,style:l,onPageChange:i}),"first"),s&&o.a.createElement("button",d({pageValue:c,style:u,onPageChange:i}),"<"),a.map((function(e){var a=null;return t===e&&(a={backgroundColor:"#ff4067"}),o.a.createElement("button",d({pageValue:e,key:e,style:a,onPageChange:i}),e)})),n&&o.a.createElement("button",d({pageValue:r,style:u,onPageChange:i}),">"),o.a.createElement("button",d({pageValue:m,style:l,onPageChange:i}),"last"))})),0!=r?r.map((function(e){if(e.id===c)return o.a.createElement("ul",null,e.item.map((function(e){return e.recipientId===s?o.a.createElement("div",{className:"col-sm-12"},o.a.createElement("div",{key:e.id,className:"section-dialogs-inner-active-message col-sm-6 col-sm-offset-6"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-10 col-centered"},o.a.createElement("div",{className:"section-dialogs-inner-active-message-item center-block"},o.a.createElement("p",{className:"wrapword"},e.body))),o.a.createElement("div",{className:"col-sm-2"},o.a.createElement("div",{className:"section-dialogs-inner-active-message-avatar"},o.a.createElement("img",{className:"rounded-circle",src:t||E.a,alt:""})))))):o.a.createElement("div",{className:"col-sm-12"},o.a.createElement("div",{key:e.id,className:"section-dialogs-inner-active-message col-sm-6"},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-2"},o.a.createElement("div",{className:"section-dialogs-inner-active-message-avatar"},o.a.createElement("img",{className:"rounded-circle",src:t||E.a,alt:""}))),o.a.createElement("div",{className:"col-sm-10"},o.a.createElement("div",{className:"section-dialogs-inner-active-message-item center-block"},o.a.createElement("p",null,e.body))))))})))})):o.a.createElement(w.a,{isLoading:!0}))},S=function(e){var a=e.id,t=e.avatar,n=e.instance,l=Object(i.useState)(!1),u=Object(r.a)(l,2),m=u[0],d=u[1],g=Object(i.useState)([]),v=Object(r.a)(g,2),E=v[0],p=v[1],j=Object(i.useState)(!1),O=Object(r.a)(j,2),N=O[0],k=O[1],S=Object(i.useState)(!1),C=Object(r.a)(S,2),x=C[0],M=C[1],L=Object(i.useState)(0),T=Object(r.a)(L,2),V=T[0],A=T[1],D=Object(i.useState)(1),F=Object(r.a)(D,2),I=F[0],q=F[1],J=Object(i.useState)(!1),R=Object(r.a)(J,2),U=R[0],K=R[1],W=function(){var e=Object(c.a)(s.a.mark((function e(){var t,c,r,i,o,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.get("/dialogs/".concat(a,"/messages?page=").concat(I,"&count=10"));case 2:200===(t=e.sent).status&&(!1===m?(c=[{id:1,item:t.data.items}],p(c),A(t.data.totalCount),d(!0)):(A(t.data.totalCount),r=E.reduce((function(e,a){return Object.assign(e,Object(b.a)({},a.id,a.item))}),{}),I>1?E.length>1&&!0===x?y.isEqual(t.data.items,r[I])||(i=[].concat(Object(f.a)(E),[E[I-1]=[I,t.data.items]]),p(i)):(o=[].concat(Object(f.a)(E),[{id:I,item:t.data.items}]),p(o),M(!0)):y.isEqual(t.data.items,r)||(l=[{id:1,item:t.data.items}],p(l),M(!1),console.log("STATE UPDATE"))));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Y=Object(i.useCallback)(function(){var e=Object(c.a)(s.a.mark((function e(t){var c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=t.message,!N){e.next=3;break}return e.abrupt("return");case 3:return k(!0),e.next=6,n.post("/dialogs/".concat(a,"/messages"),{body:c});case 6:q(I),W(),k(!1);case 9:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),[N]);setTimeout((function(){K(!U)}),1e4),Object(i.useEffect)((function(){return!1===m&&(d(!0),W()),function(){}}),[]);return Object(i.useEffect)((function(){return W(),function(){}}),[U,I]),!1===m?o.a.createElement("div",{className:"MessagesLoader"},o.a.createElement(w.a,{isLoading:!0})):o.a.createElement("div",{className:"section-dialogs-inner-active"},o.a.createElement(P,{avatar:t,id:a,setPageCurrent:function(e){q(e),M(!1),W()},currentPage:I,mainMessageData:E,total:V}),o.a.createElement(h,{onSubmit:Y}))},C=function(e){var a=e.membersList,t=e.instance;if(null===a)return o.a.createElement("div",{className:"MessagesLoader"},o.a.createElement(w.a,{isLoading:!0}));var n=a.map((function(e){return o.a.createElement(p.b,{key:e.id,path:"/home/dialogs/".concat(e.id),render:function(){return o.a.createElement(S,{instance:t,key:e.id,avatar:e.photos.small,id:e.id})}})}));return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"section-dialogs-inner-active"},n))},x=t(22).create({withCredentials:!0,headers:{"API-KEY":"9832db98-b9d3-460c-9cab-5d06ff193b07"},baseURL:"https://social-network.samuraijs.com/api/1.0/"});a.default=function(){var e=Object(i.useState)([]),a=Object(r.a)(e,2),t=a[0],n=a[1];return Object(i.useEffect)((function(){return function(){var e=Object(c.a)(s.a.mark((function e(){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.get("/dialogs");case 2:200===(a=e.sent).status&&n(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),function(){n([])}}),[]),o.a.createElement(l.a,null,o.a.createElement("div",{className:"section-dialogs"},o.a.createElement("div",{className:"section-dialogs-inner"},o.a.createElement("div",{className:"col-sm-4"},o.a.createElement(g,{instance:x})),o.a.createElement(C,{instance:x,membersList:t}))))}}}]);
//# sourceMappingURL=4.a4777f10.chunk.js.map